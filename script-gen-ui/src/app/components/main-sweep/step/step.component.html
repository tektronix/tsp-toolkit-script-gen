<div
  class="component-box"
  [ngClass]="{ active: isActive }"
  [style.border]="isActive ? '1px solid ' + color : null"
  [style.background-color]="
    isActive ? 'var(--vscode-activityErrorBadge-foreground)' : null
  "
>
  <div
    class="expander"
    [style.background-color]="
      isActive ? 'var(--vscode-activityBar-background)' : 'transparent'
    "
  >
    <div style="display: flex">
      <mat-icon (click)="toggleStepChannel(chanName)" class="h3">
        {{ expandedStepChannels[chanName] ? "expand_more" : "chevron_right" }}
      </mat-icon>
      <h3>
        {{ chanName }}
      </h3>
    </div>
    <button class="delete-button-icon" (click)="removeStep()">
      <mat-icon>delete</mat-icon>
    </button>
  </div>
  <div *ngIf="expandedStepChannels[chanName]" class="input-group">
    <div>
      <app-dropdown
        [(ngModel)]="deviceID"
        [label]="'ID'"
        [selected]="deviceID"
        [options]="dropdownDeviceList"
        (selectedChange)="onDeviceIDChange($event)"
        *ngIf="deviceID"
        name="deviceID"
      ></app-dropdown>
    </div>
    <div class="numeric-control">
      <app-input-numeric
        [(ngModel)]="stepPoints.value"
        [label]="'Number of Steps'"
        *ngIf="stepPoints"
        name="stepPoints"
        (inputChange)="submitStepGlobalParamsData()"
      ></app-input-numeric>
    </div>
    <div>
      <app-input-plain
        [(ngModel)]="stepToSweepDelay.value"
        [label]="'Step-to-Sweep Delay'"
        [unit]="stepToSweepDelay.unit"
        *ngIf="stepToSweepDelay"
        name="stepToSweepDelay"
        (inputChange)="submitStepGlobalParamsData()"
      ></app-input-plain>
    </div>
    <div class="start-stop-container">
      <app-input-plain
        [(ngModel)]="start.value"
        [label]="'Start'"
        [unit]="start.unit"
        *ngIf="start"
        name="start"
        (inputChange)="submitStepData()"
      ></app-input-plain>
      <app-input-plain
        [(ngModel)]="stop.value"
        [label]="'Stop'"
        [unit]="stop.unit"
        *ngIf="stop"
        name="stepStop"
        (inputChange)="submitStepData()"
      ></app-input-plain>
    </div>
    <div>
      <app-input-toggle
        [(ngModel)]="sourceFunction.value"
        [label]="'Source Function'"
        [options]="sourceFunction.range"
        *ngIf="sourceFunction"
        name="sourceFunction"
        (toggleOptionChange)="submitStepData()"
      ></app-input-toggle>
    </div>
    <div>
      <app-dropdown
        [(ngModel)]="sourceRange.value"
        [label]="'Source Range'"
        [selected]="sourceRange.value"
        [options]="sourceRange.range"
        *ngIf="sourceRange"
        name="sourceRange"
        (selectedChange)="submitStepData()"
      ></app-dropdown>
    </div>
    <div>
      <app-dropdown
        [(ngModel)]="measFunction.value"
        [label]="'Meas. Function'"
        [selected]="measFunction.value"
        [options]="measFunction.range"
        *ngIf="measFunction"
        name="measFunction"
        (selectedChange)="submitStepData()"
      ></app-dropdown>
    </div>
    <div>
      <app-dropdown
        [(ngModel)]="measRange.value"
        [label]="'Meas. Range'"
        [selected]="measRange.value"
        [options]="measRange.range"
        *ngIf="measRange"
        name="measRange"
        (selectedChange)="submitStepData()"
      ></app-dropdown>
    </div>
    <div>
      <app-input-toggle
        [(ngModel)]="style.value"
        [label]="'Style'"
        [options]="style.range"
        *ngIf="style"
        name="style"
        (toggleOptionChange)="submitStepData()"
      ></app-input-toggle>
    </div>
    <div class="checkbox">
      <label for="list">List</label>
      <input
        type="checkbox"
        id="list"
        [(ngModel)]="list"
        name="list"
        (selectionchange)="submitStepGlobalParamsData()"
      />
      <button class="timing">Edit</button>
    </div>
    <div>
      <app-dropdown
        [(ngModel)]="senseMode.value"
        [label]="'Sense Mode'"
        [selected]="senseMode.value"
        [options]="senseMode.range"
        *ngIf="senseMode"
        name="senseMode"
        (selectedChange)="submitStepData()"
      ></app-dropdown>
    </div>
    <div>
      <app-input-plain
        [(ngModel)]="sourceLimitI.value"
        [label]="'Source Limit I'"
        [unit]="sourceLimitI.unit"
        *ngIf="sourceLimitI"
        name="sourceLimitI"
        (inputChange)="submitStepData()"
      ></app-input-plain>
    </div>
    <div>
      <app-input-plain
        [(ngModel)]="sourceLimitV.value"
        [label]="'Source Limit V'"
        [unit]="sourceLimitV.unit"
        *ngIf="sourceLimitV"
        name="sourceLimitV"
        (inputChange)="submitStepData()"
      ></app-input-plain>
    </div>
  </div>
</div>
