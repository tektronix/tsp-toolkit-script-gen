<div
  class="component-box"
  [attr.aria-label]="'Sweep Component'"
  [ngClass]="{ active: isActive }"
  [style.border]="isActive ? '1px solid ' + color : null"
  [style.background-color]="
    isActive ? 'var(--vscode-activityErrorBadge-foreground)' : null
  "
>
  <div
    class="expander"
    [style.background-color]="
      selectedDeviceOption?.isValid
        ? isActive
          ? 'var(--vscode-activityBar-background)'
          : 'transparent'
        : 'var(--vscode-editorOverviewRuler-errorForeground)'
    "
  >
    <div style="display: flex">
      <button class="h3-button" [attr.aria-label]="'sweepExpander'">
        <mat-icon
          (click)="toggleSweepChannel()"
          [attr.aria-label]="'sweepExpander'"
          class="h3"
        >
          {{ isSweepExpanded ? "expand_more" : "chevron_right" }}
        </mat-icon>
      </button>
      <h3
        tabindex="0"
        (click)="toggleSweepChannel()"
        (keydown)="handleKeydown($event)"
      >
        {{ chanName }}
      </h3>
    </div>
    <button
      class="delete-button-icon"
      [attr.aria-label]="'Delete Sweep'"
      (click)="removeSweep()"
    >
      <mat-icon>delete</mat-icon>
    </button>
  </div>
  <div *ngIf="isSweepExpanded" class="input-group">
    <div>
      <app-channel-dropdown
        [(ngModel)]="selectedDeviceOption"
        [label]="'ID'"
        automationID="Id"
        [selected]="selectedDeviceOption"
        [options]="deviceOptionList"
        *ngIf="selectedDeviceOption"
        name="selectedDeviceOption"
        (selectedChange)="onDeviceIDChange($event)"
      ></app-channel-dropdown>
    </div>
    <div class="sweep-start-stop-container">
      <app-input-plain
        [(ngModel)]="start.value"
        [label]="'Start'"
        [unit]="start.unit"
        *ngIf="start"
        name="start"
        automationID="SweepStart"
        (inputChange)="submitSweepData()"
        [disabled]="!selectedDeviceOption?.isValid"
      ></app-input-plain>
      <app-input-plain
        [(ngModel)]="stop.value"
        [label]="'Stop'"
        [unit]="stop.unit"
        *ngIf="stop"
        name="stop"
        automationID="SweepStop"
        (inputChange)="submitSweepData()"
        [disabled]="!selectedDeviceOption?.isValid"
      ></app-input-plain>
    </div>
    <div>
      <app-input-toggle
        [(ngModel)]="sourceFunction.value"
        [label]="'Source Function'"
        [options]="sourceFunction.range"
        *ngIf="sourceFunction"
        name="sourceFunction"
        automationID="SourceFunction"
        (toggleOptionChange)="submitSweepData()"
        [disabled]="!selectedDeviceOption?.isValid"
      ></app-input-toggle>
    </div>
    <div>
      <app-dropdown
        [(ngModel)]="sourceRange.value"
        [label]="'Source Range'"
        [selected]="sourceRange.value"
        [options]="sourceRange.range"
        *ngIf="sourceRange"
        name="sourceRange"
        automationID="SourceRange"
        (selectedChange)="submitSweepData()"
        [disabled]="!selectedDeviceOption?.isValid"
      ></app-dropdown>
    </div>
    <div>
      <app-dropdown
        [(ngModel)]="measFunction.value"
        [label]="'Measure Function'"
        [selected]="measFunction.value"
        [options]="measFunction.range"
        *ngIf="measFunction"
        name="measFunction"
        automationID="MeasureFunction"
        (selectedChange)="submitSweepData()"
        [disabled]="!selectedDeviceOption?.isValid"
      ></app-dropdown>
    </div>
    <div>
      <app-dropdown
        [(ngModel)]="measRange.value"
        [label]="'Measure Range'"
        [selected]="measRange.value"
        [options]="measRange.range"
        *ngIf="measRange"
        name="measRange"
        automationID="MeasureRange"
        (selectedChange)="submitSweepData()"
        [disabled]="!selectedDeviceOption?.isValid"
      ></app-dropdown>
    </div>
    <div>
      <app-input-toggle
        [(ngModel)]="style.value"
        [label]="'Style'"
        [options]="style.range"
        *ngIf="style"
        name="style"
        automationID="style"
        (toggleOptionChange)="submitSweepData()"
        [disabled]="!selectedDeviceOption?.isValid"
      ></app-input-toggle>
    </div>
    <div>
      <app-dropdown
        [(ngModel)]="senseMode.value"
        [label]="'Sense Mode'"
        [selected]="senseMode.value"
        [options]="senseMode.range"
        *ngIf="senseMode"
        name="senseMode"
        automationID="SenseMode"
        (selectedChange)="submitSweepData()"
        [disabled]="!selectedDeviceOption?.isValid"
      ></app-dropdown>
    </div>
    <div>
      <app-input-plain
        [(ngModel)]="sourceLimitI.value"
        [label]="'Source Limit I'"
        [unit]="sourceLimitI.unit"
        *ngIf="sourceLimitI"
        name="sourceLimitI"
        automationID="SourceLimitI"
        (inputChange)="submitSweepData()"
        [disabled]="!selectedDeviceOption?.isValid"
      ></app-input-plain>
    </div>
    <div>
      <app-input-plain
        [(ngModel)]="sourceLimitV.value"
        [label]="'Source Limit V'"
        [unit]="sourceLimitV.unit"
        *ngIf="sourceLimitV"
        name="sourceLimitV"
        automationID="SourceLimitV"
        (inputChange)="submitSweepData()"
        [disabled]="!selectedDeviceOption?.isValid"
      ></app-input-plain>
    </div>
  </div>
</div>
